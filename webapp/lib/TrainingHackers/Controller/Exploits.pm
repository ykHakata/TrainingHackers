package TrainingHackers::Controller::Exploits;
use strict;
use warnings;
use parent qw(TrainingHackers::Controller::Auth);

sub index {
    my $self = shift;

    my $params = $self->parameters;
    $self->stash(q => $params, question_id => $self->session->data->{question}->{id});

    if ($self->method eq 'GET') {
        return $self->render('exploits/index.tx');
    }

    if (!$params->{textarea}) {
        $self->stash(error => 1);
        return $self->render('exploits/index.tx');
    }

    if ($params->{textarea} =~ /<[a-zA-Z]+/) {
        $self->stash(success => 1);
    }
    $self->stash(code => $params->{textarea});
    $self->session->data->{user_answer} = $params->{textarea};
    return $self->render('exploits/index.tx');
}

1;
